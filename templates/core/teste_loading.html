{% extends 'base.html' %}

{% block title %}Teste do Sistema de Loading{% endblock %}

{% block content %}
<div class="container mt-4">
    <div class="row">
        <div class="col-12">
            <div class="card">
                <div class="card-header bg-primary text-white">
                    <h4 class="mb-0">
                        <i class="fas fa-vial me-2"></i>
                        Demonstra√ß√£o do Sistema de Loading
                    </h4>
                </div>
                <div class="card-body">
                    <div class="alert alert-info">
                        <h5><i class="fas fa-info-circle me-2"></i>Como Testar</h5>
                        <p class="mb-2">O sistema de loading agora mostra <strong>porcentagem real</strong>! Teste os bot√µes abaixo:</p>
                        <ul class="mb-0">
                            <li><strong>Progresso Autom√°tico:</strong> Cada tipo de opera√ß√£o tem etapas realistas</li>
                            <li><strong>Porcentagem Din√¢mica:</strong> Mostra 0% at√© 100% com mensagens espec√≠ficas</li>
                            <li><strong>Detec√ß√£o Inteligente:</strong> Upload, Save, Delete, etc. t√™m progressos √∫nicos</li>
                        </ul>
                    </div>

                    <!-- Bot√µes de Teste Autom√°tico -->
                    <div class="row mb-5">
                        <div class="col-12">
                            <h5 class="text-primary mb-3">
                                <i class="fas fa-magic me-2"></i>
                                Loading Autom√°tico (Baseado no Contexto)
                            </h5>
                            <div class="row g-3">
                                <div class="col-md-4">
                                    <button class="btn btn-success w-100" onclick="simulateAction()">
                                        <i class="fas fa-save me-2"></i>
                                        Salvar Dados
                                    </button>
                                    <small class="text-muted">Save: 4 etapas de valida√ß√£o</small>
                                </div>
                                <div class="col-md-4">
                                    <button class="btn btn-danger w-100" onclick="simulateAction()">
                                        <i class="fas fa-trash me-2"></i>
                                        Excluir Item
                                    </button>
                                    <small class="text-muted">Delete: 3 etapas de remo√ß√£o</small>
                                </div>
                                <div class="col-md-4">
                                    <button class="btn btn-info w-100" onclick="simulateAction()">
                                        <i class="fas fa-search me-2"></i>
                                        Buscar Dados
                                    </button>
                                    <small class="text-muted">Search: 3 etapas r√°pidas</small>
                                </div>
                                <div class="col-md-4">
                                    <button class="btn btn-warning w-100" onclick="simulateAction()">
                                        <i class="fas fa-upload me-2"></i>
                                        Enviar Arquivo
                                    </button>
                                    <small class="text-muted">Upload: 5 etapas realistas</small>
                                </div>
                                <div class="col-md-4">
                                    <button class="btn btn-secondary w-100" onclick="simulateAction()">
                                        <i class="fas fa-cog me-2"></i>
                                        Processar
                                    </button>
                                    <small class="text-muted">Process: 4 etapas completas</small>
                                </div>
                                <div class="col-md-4">
                                    <button class="btn btn-primary w-100" onclick="simulateAction()">
                                        <i class="fas fa-file-export me-2"></i>
                                        Exportar Relat√≥rio
                                    </button>
                                    <small class="text-muted">Export: 4 etapas detalhadas</small>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Loading Manual -->
                    <div class="row mb-5">
                        <div class="col-12">
                            <h5 class="text-primary mb-3">
                                <i class="fas fa-hand-pointer me-2"></i>
                                Loading Manual (Controle Personalizado)
                            </h5>
                            <div class="row g-3">
                                <div class="col-md-3">
                                    <button class="btn btn-outline-primary w-100" onclick="showRealisticLoading()">
                                        Loading Realista
                                    </button>
                                </div>
                                <div class="col-md-3">
                                    <button class="btn btn-outline-success w-100" onclick="showProgressLoading()">
                                        Progresso Customizado
                                    </button>
                                </div>
                                <div class="col-md-3">
                                    <button class="btn btn-outline-warning w-100" onclick="showUploadExample()">
                                        Simular Upload
                                    </button>
                                </div>
                                <div class="col-md-3">
                                    <button class="btn btn-outline-danger w-100" onclick="hideLoading()">
                                        Parar Loading
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Formul√°rios de Teste -->
                    <div class="row mb-5">
                        <div class="col-12">
                            <h5 class="text-primary mb-3">
                                <i class="fas fa-wpforms me-2"></i>
                                Loading de Formul√°rios
                            </h5>
                            
                            <div class="row">
                                <!-- Formul√°rio de Upload -->
                                <div class="col-md-6">
                                    <div class="card border-success">
                                        <div class="card-header bg-success text-white">
                                            <h6 class="mb-0">Upload de Arquivo</h6>
                                        </div>
                                        <div class="card-body">
                                            <form method="post" enctype="multipart/form-data" action="#" onsubmit="return false;">
                                                <div class="mb-3">
                                                    <label class="form-label">Selecionar Arquivo:</label>
                                                    <input type="file" class="form-control" name="arquivo" accept=".xlsx,.xls,.csv">
                                                </div>
                                                <button type="submit" class="btn btn-success w-100">
                                                    <i class="fas fa-cloud-upload me-2"></i>
                                                    Enviar Arquivo
                                                </button>
                                            </form>
                                            <small class="text-muted mt-2 d-block">
                                                Detecta automaticamente upload e mostra modal
                                            </small>
                                        </div>
                                    </div>
                                </div>

                                <!-- Formul√°rio de Busca -->
                                <div class="col-md-6">
                                    <div class="card border-info">
                                        <div class="card-header bg-info text-white">
                                            <h6 class="mb-0">Busca Avan√ßada</h6>
                                        </div>
                                        <div class="card-body">
                                            <form method="get" action="#" onsubmit="return false;">
                                                <div class="mb-3">
                                                    <label class="form-label">Termo de Busca:</label>
                                                    <input type="text" class="form-control" name="q" placeholder="Digite sua busca...">
                                                </div>
                                                <button type="submit" class="btn btn-info w-100">
                                                    <i class="fas fa-search me-2"></i>
                                                    Buscar Dados
                                                </button>
                                            </form>
                                            <small class="text-muted mt-2 d-block">
                                                Loading autom√°tico no bot√£o de busca
                                            </small>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Exemplos de JavaScript -->
                    <div class="row">
                        <div class="col-12">
                            <h5 class="text-primary mb-3">
                                <i class="fas fa-code me-2"></i>
                                Exemplos de C√≥digo JavaScript
                            </h5>
                            
                            <div class="accordion" id="codeExamples">
                                <div class="accordion-item">
                                    <h6 class="accordion-header">
                                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#example1">
                                            <i class="fas fa-code me-2"></i>
                                            Loading Simples
                                        </button>
                                    </h6>
                                    <div id="example1" class="accordion-collapse collapse" data-bs-parent="#codeExamples">
                                        <div class="accordion-body">
                                            <pre><code>// Loading com progresso autom√°tico realista
showLoading({ type: 'upload' });

// Upload ter√° 5 etapas:
// 10% - "Preparando arquivo..."
// 30% - "Validando formato..." 
// 60% - "Enviando dados..."
// 85% - "Processando informa√ß√µes..."
// 100% - "Upload conclu√≠do!"</code></pre>
                                        </div>
                                    </div>
                                </div>

                                <div class="accordion-item">
                                    <h6 class="accordion-header">
                                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#example2">
                                            <i class="fas fa-code me-2"></i>
                                            Loading Personalizado
                                        </button>
                                    </h6>
                                    <div id="example2" class="accordion-collapse collapse" data-bs-parent="#codeExamples">
                                        <div class="accordion-body">
                                            <pre><code>// Loading personalizado com auto-progresso
showLoading({
    message: 'Salvando dados...',
    type: 'save'  // 4 etapas autom√°ticas
});

// Loading sem auto-progresso
showLoading({
    message: 'Opera√ß√£o customizada',
    autoProgress: false,
    progress: 0
});</code></pre>
                                        </div>
                                    </div>
                                </div>

                                <div class="accordion-item">
                                    <h6 class="accordion-header">
                                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#example3">
                                            <i class="fas fa-code me-2"></i>
                                            Loading com Progresso
                                        </button>
                                    </h6>
                                    <div id="example3" class="accordion-collapse collapse" data-bs-parent="#codeExamples">
                                        <div class="accordion-body">
                                            <pre><code>// Progresso manual com controle total
showLoading({ 
    progress: 0, 
    autoProgress: false,
    message: 'Iniciando...'
});

// Atualizar manualmente
updateLoadingProgress(25, 'Processando arquivo...');
updateLoadingProgress(50, 'Analisando dados...');
updateLoadingProgress(75, 'Salvando resultados...');
updateLoadingProgress(100, 'Conclu√≠do!');</code></pre>
                                        </div>
                                    </div>
                                </div>

                                <div class="accordion-item">
                                    <h6 class="accordion-header">
                                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#example4">
                                            <i class="fas fa-code me-2"></i>
                                            Loading em Bot√£o Espec√≠fico
                                        </button>
                                    </h6>
                                    <div id="example4" class="accordion-collapse collapse" data-bs-parent="#codeExamples">
                                        <div class="accordion-body">
                                            <pre><code>// Aplicar loading a um bot√£o
const btn = document.getElementById('meuBotao');
Loading.setButtonLoading(btn, {
    text: 'Salvando...',
    type: 'save'
});

// Remover loading do bot√£o
Loading.clearButtonLoading(btn);</code></pre>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
// Simular a√ß√£o com delay
function simulateAction() {
    setTimeout(() => {
        // O loading ser√° removido automaticamente pelo sistema
        console.log('A√ß√£o simulada conclu√≠da');
    }, 3000);
}

// Exemplos de loading manual
function showRealisticLoading() {
    // Mostra loading autom√°tico do tipo 'process' com progresso realista
    showLoading({ type: 'process' });
}

function showProgressLoading() {
    // Progresso manual personalizado
    showLoading({ 
        progress: 0, 
        autoProgress: false,
        message: 'Progresso Customizado',
        type: 'save'
    });
    
    let progress = 0;
    const interval = setInterval(() => {
        progress += 15;
        if (progress <= 100) {
            updateLoadingProgress(progress, `Processando: ${progress}%`);
        }
        
        if (progress >= 100) {
            clearInterval(interval);
            setTimeout(hideLoading, 1000);
        }
    }, 400);
}

function showUploadExample() {
    // Demonstra upload com etapas realistas
    showLoading({ type: 'upload' });
}

// Log de eventos para debug
document.addEventListener('DOMContentLoaded', function() {
    console.log('üß™ P√°gina de Teste do Loading com Progresso Real carregada!');
    console.log('üéØ Novidades:');
    console.log('   ‚Ä¢ Progresso autom√°tico por tipo de opera√ß√£o');
    console.log('   ‚Ä¢ Porcentagem real (0% at√© 100%)');
    console.log('   ‚Ä¢ Etapas realistas para cada tipo');
    console.log('üìã M√©todos dispon√≠veis:');
    console.log('   ‚Ä¢ showLoading({ type: "upload" }) - Progresso autom√°tico');
    console.log('   ‚Ä¢ showLoading({ progress: 0, autoProgress: false }) - Manual');
    console.log('   ‚Ä¢ updateLoadingProgress(progress, message)');
    console.log('   ‚Ä¢ hideLoading()');
});
</script>
{% endblock %}